<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Dauntless Scheduler v2.5 — FullCloud</title>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#1E1F23"/>
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Dauntless Scheduler <span class="ver">v2.5 — FullCloud</span></h1>
      <button class="btn gold" id="btnInstall">加到主畫面</button>
    </header>

    <div class="toolbar">
      <span class="pill">資料源：<b id="srcLabel">偵測中</b></span>
      <span class="pill"><span class="dot dot-green"></span> 已排賽程</span>
      <span class="pill"><span class="dot dot-red"></span> 需避開（日）</span>
      <button id="btnEdit" class="btn">📝 建立／編輯賽程</button>
      <button id="btnAvoid" class="btn">🔴 查詢需避開（日）</button>
      <button id="btnReload" class="btn">↻ 重新載入</button>
    </div>

    <div class="kpi">
      <div class="metric"><h3>本季週日數</h3><div class="num" id="k_total">—</div></div>
      <div class="metric"><h3>本季已排</h3><div class="num" id="k_q1">—</div></div>
      <div class="metric"><h3>次季已排</h3><div class="num" id="k_q2">—</div></div>
      <div class="metric"><h3>需避開（總）</h3><div class="num" id="k_avoid">—</div></div>
    </div>

    <div class="grid">
      <section class="card">
        <div class="title"><b id="q1Title">本季（日）</b></div>
        <div id="q1List"></div>
      </section>
      <section class="card">
        <div class="title"><b id="q2Title">次季（日）</b></div>
        <div id="q2List"></div>
      </section>
    </div>
  </div>

  <footer>© 2025 Dauntless Scheduler — FullCloud v2.5</footer>

  <!-- 建立／編輯賽程 -->
  <dialog id="editDlg">
    <form method="dialog" class="form" id="editForm">
      <h3 class="dlg-title">建立 / 編輯賽程</h3>
      <div class="row">
        <div>
          <label>日期（週日）</label>
          <input type="date" id="f_date" required/>
        </div>
        <div>
          <label>聯盟</label>
          <select id="f_league">
            <option value="海客聯盟">海客聯盟</option>
            <option value="美堤聯盟">美堤聯盟</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div>
          <label>狀態</label>
          <select id="f_status">
            <option value="已排">已排</option>
            <option value="需避開">需避開</option>
          </select>
        </div>
        <div>
          <label>備註</label>
          <input type="text" id="f_note" placeholder="可留空"/>
        </div>
      </div>
      <div class="hint">※ 雲端寫入：請在 <code>js/cloud.js</code> 設定 CSV 連結與 GAS Web App URL。</div>
      <div class="actions">
        <button class="btn" value="cancel">取消</button>
        <button class="btn primary" id="btnSave" value="default">儲存</button>
      </div>
    </form>
  </dialog>

  <!-- 需避開（日） -->
  <dialog id="avoidDlg">
    <div class="title"><b>需避開（日）清單 — 兩季</b></div>
    <div id="avoidList"></div>
    <div class="actions" style="justify-content:flex-end">
      <button class="btn" onclick="document.getElementById('avoidDlg').close()">關閉</button>
    </div>
  </dialog>

  <script src="js/cloud.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/app.js"></script>
  <script>if('serviceWorker' in navigator){navigator.serviceWorker.register('./service-worker.js');}</script>
</body>
</html>
