<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>Dauntless Scheduler v2.3 â€” CloudLink</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#1E1F23"/>
<link rel="apple-touch-icon" href="icons/icon-192.png">
<style>
:root{--bg:#181A1F;--panel:#21242b;--ink:#e8e6df;--muted:#b0b0b0;--gold:#C8B47E;--chip:#2b2f36;--chip2:#303641}
*{box-sizing:border-box}html,body{margin:0;height:100%;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
.wrap{max-width:980px;margin:0 auto;padding:20px 16px 120px}
header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
h1{font-size:22px;margin:0;font-weight:700}
.badge{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(180deg,#262a31,#1f232a);padding:8px 12px;border-radius:12px;border:1px solid #333}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:16px}
.card{background:var(--panel);border:1px solid #2f3440;border-radius:16px;padding:12px 12px}
.title{display:flex;align-items:center;gap:10px;margin:2px 0 8px}
.title b{color:var(--gold);font-size:14px}
.pill{display:inline-flex;gap:6px;align-items:center;background:#2b2f36;border:1px solid #3a3f4a;color:#cfd2d7;border-radius:999px;padding:6px 10px;font-size:12px;margin-right:8px}
.kpi{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin:12px 0}
.kpi .metric{background:var(--chip);border:1px solid #343a46;border-radius:12px;padding:10px}
.metric h3{margin:4px 0 6px;font-size:12px;color:#b8bec8;font-weight:500}
.metric .num{font-size:22px;font-weight:700;color:#fff}
.slot{display:flex;align-items:center;justify-content:space-between;background:var(--chip2);border:1px solid #3b4150;border-radius:14px;padding:10px 12px;margin:8px 0}
.slot .left{display:flex;align-items:center;gap:10px}
.dot{width:10px;height:10px;border-radius:50%;background:#6b7c90;opacity:.9}
.slot .date{font-weight:700}
.slot .range{font-size:12px;color:#9aa3ad}
.slot .tags{display:flex;gap:6px}
.tag{font-size:11px;border-radius:999px;padding:4px 8px;border:1px solid #3a3f4a}
.tag.green{background:#1e2a26;color:#9fe6cc;border-color:#1f3b33}
.tag.red{background:#311a21;color:#ffb8c7;border-color:#4b2731}
.btn{appearance:none;border:none;background:#2b2f36;color:#eaeaea;border:1px solid #444;padding:10px 14px;border-radius:12px;font-weight:600;letter-spacing:.3px;cursor:pointer}
.btn.gold{background:linear-gradient(180deg,#3a3a35,#2a2a27);color:var(--gold);border-color:#47443a}
.btn.primary{background:#2f6;color:#081;border-color:#194}
.btn.block{width:100%}
.toolbar{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}
/* modal */
dialog{border:none;background:#21242b;color:var(--ink);border-radius:16px;max-width:520px;width:92%;padding:18px 16px;border:1px solid #343a46}
.form{display:grid;gap:10px;margin-top:6px}
label{font-size:12px;color:#c7c7c7}
input[type="date"],select,input[type="text"]{width:100%;padding:10px;border-radius:10px;border:1px solid #3b4150;background:#1d2026;color:#e9ecef}
.row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.btn.small{padding:6px 10px;border-radius:10px;font-size:12px}
.warn{color:#ffb3bf;font-size:12px}
@media (max-width:680px){.kpi{grid-template-columns:repeat(2,1fr)}.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Dauntless Scheduler v2.3 â€” <span style="color:#C8B47E">CloudLink</span></h1>
    <button class="btn gold" id="btnInstall">åŠ åˆ°ä¸»ç•«é¢</button>
  </header>
  <div class="toolbar">
    <span class="pill">è³‡æ–™æºï¼š<b id="srcLabel">é›²ç«¯</b></span>
    <span class="pill"><span style="width:10px;height:10px;border-radius:50%;background:#9fe6cc;display:inline-block"></span> å·²æ’è³½ç¨‹</span>
    <span class="pill"><span style="width:10px;height:10px;border-radius:50%;background:#ff6b81;display:inline-block"></span> éœ€é¿é–‹ï¼ˆæ—¥ï¼‰</span>
    <button id="btnNew" class="btn">ğŸ“ å»ºç«‹ / ç·¨è¼¯è³½ç¨‹</button>
    <button id="btnAvoid" class="btn">ğŸ”´ æŸ¥è©¢éœ€é¿é–‹ï¼ˆæ—¥ï¼‰</button>
    <button id="btnReload" class="btn">â†» é‡æ–°è¼‰å…¥</button>
  </div>

  <div class="kpi">
    <div class="metric"><h3>æœ¬å­£é€±æ—¥æ•¸</h3><div class="num" id="k_total">â€”</div></div>
    <div class="metric"><h3>æœ¬å­£å·²æ’</h3><div class="num" id="k_q1">â€”</div></div>
    <div class="metric"><h3>æ¬¡å­£å·²æ’</h3><div class="num" id="k_q2">â€”</div></div>
    <div class="metric"><h3>éœ€é¿é–‹ï¼ˆç¸½ï¼‰</h3><div class="num" id="k_avoid">â€”</div></div>
  </div>

  <div class="grid">
    <section class="card">
      <div class="title"><b id="q1Title">æœ¬å­£ï¼ˆæ—¥ï¼‰</b></div>
      <div id="q1List"></div>
    </section>
    <section class="card">
      <div class="title"><b id="q2Title">æ¬¡å­£ï¼ˆæ—¥ï¼‰</b></div>
      <div id="q2List"></div>
    </section>
  </div>
</div>

<footer style="position:fixed;left:0;right:0;bottom:0;background:rgba(20,22,26,.92);border-top:1px solid #2f3440;display:flex;justify-content:center;padding:10px 0;color:#9aa3ad">Â© 2025 Dauntless Scheduler â€” CloudLink v2.3</footer>

<dialog id="editDlg">
  <form method="dialog" class="form" id="editForm">
    <h3 style="margin:0">å»ºç«‹ / ç·¨è¼¯è³½ç¨‹</h3>
    <div class="row">
      <div>
        <label>æ—¥æœŸï¼ˆé€±æ—¥ï¼‰</label>
        <input type="date" id="f_date" required />
      </div>
      <div>
        <label>è¯ç›Ÿ</label>
        <select id="f_league">
          <option value="TSAA">TSAA</option>
          <option value="å…¶ä»–">å…¶ä»–</option>
        </select>
      </div>
    </div>
    <div class="row">
      <div>
        <label>ç‹€æ…‹</label>
        <select id="f_status">
          <option value="å·²æ’">å·²æ’</option>
          <option value="éœ€é¿é–‹">éœ€é¿é–‹</option>
        </select>
      </div>
      <div>
        <label>å‚™è¨»ï¼ˆå¯ç•™ç©ºï¼‰</label>
        <input type="text" id="f_note" placeholder="å¯é¸å¡«ç°¡çŸ­å‚™è¨»"/>
      </div>
    </div>
    <div class="warn">â€» å¯«å…¥é›²ç«¯éœ€å…ˆåœ¨ app.js å¡«å¥½ Google Apps Script API_URLã€‚</div>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:6px">
      <button class="btn small" value="cancel">å–æ¶ˆ</button>
      <button class="btn small primary" id="btnSave" value="default">å„²å­˜</button>
    </div>
  </form>
</dialog>

<dialog id="avoidDlg">
  <div class="title"><b>éœ€é¿é–‹ï¼ˆæ—¥ï¼‰æ¸…å–® â€” å…©å­£</b></div>
  <div id="avoidList"></div>
  <div style="text-align:right;margin-top:10px"><button class="btn small" onclick="document.getElementById('avoidDlg').close()">é—œé–‰</button></div>
</dialog>

<script src="app.js"></script>
<script> if('serviceWorker' in navigator){navigator.serviceWorker.register('./service-worker.js');} </script>
</body>
</html>
