<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Dauntless Scheduler v1.9.3 â€” Dual Quarter</title>
  <link rel="icon" href="favicon.ico"/>
  <link rel="apple-touch-icon" href="icons/apple-180.png"/>
  <link rel="manifest" href="manifest.webmanifest"/>
  <link rel="stylesheet" href="styles.css"/>
  <meta name="theme-color" content="#1f2124"/>
  <meta name="description" content="TSAA ç„¡ç•è€…æ’ç¨‹å™¨ï¼šåƒ…é¡¯ç¤ºé€±æ—¥ã€é›™å­£åº¦è¦–åœ–ã€è¡Œæ”¿é™¢å‡æœŸè‡ªå‹•é¿é–‹ã€é›¢ç·šå¯ç”¨ï¼ˆPWAï¼‰ã€‚"/>
</head>
<body>
  <div class="wrap">
    <div class="row" style="justify-content:space-between">
      <div>
        <h1>Dauntless Scheduler v1.9.3</h1>
        <div class="sub">é›™å­£åº¦è¦–åœ–ï½œåƒ…é¡¯ç¤ºé€±æ—¥ï½œå‡æœŸè‡ªå‹•é¿é–‹ï½œé›¢ç·šå¯ç”¨ï¼ˆPWAï¼‰</div>
      </div>
      <div class="row">
        <button id="btnInstall" class="gold">ï¼‹ åŠ åˆ°ä¸»ç•«é¢</button>
        <button id="btnLink">ğŸ”— é€£å…¥ï¼ˆHoliday / Core / Logï¼‰</button>
      </div>
    </div>

    <div class="panel">
      <div class="row" style="justify-content:space-between">
        <div class="legend">
          <span class="chip"><span class="dot" style="background:var(--ok)"></span>å¯æ’</span>
          <span class="chip"><span class="dot" style="background:var(--busy)"></span>å·²æ’</span>
          <span class="chip"><span class="dot" style="background:var(--avoid)"></span>é¿é–‹</span>
          <span class="chip"><span class="dot" style="background:var(--empty)"></span>æœªè¨­å®š</span>
        </div>
        <div class="row">
          <select id="selStart">
            <option value="2025-11">èµ·ï¼š2025/11</option>
            <option value="2026-01">èµ·ï¼š2026/01</option>
            <option value="2026-04">èµ·ï¼š2026/04</option>
          </select>
          <button id="btnShowAvoid" class="badge" style="border-color:var(--avoid);color:#ffb3bb">ğŸ”´ æœ¬é›™å­£é¿é–‹</button>
          <button id="btnExport">åŒ¯å‡ºå ±è¡¨</button>
          <button id="btnReset">å…¨éƒ¨é‡è¨­</button>
        </div>
      </div>
      <div class="note">å‡æœŸè³‡æ–™å–è‡ªé›²ç«¯ <b>Shared_Data/Holiday/Holiday_CoreFeed.xlsx</b>ï¼ˆä»¥ã€Œé€£å…¥ã€é¸æª”ï¼‰ã€‚ä¸»æ’ç¨‹ç‚º <b>CoreControl/TSAA_Schedule_Core_v1.4.3.xlsx</b>ï¼›Log ç‚º <b>Reports/Scheduler_Log_v1.4.3.xlsx</b>ã€‚</div>
    </div>

    <div id="q1" class="panel">
      <div class="qhdr"><div class="qtitle" id="q1Title">Q?ï¼ˆMâ€“Mï¼‰</div></div>
      <div id="q1List"></div>
    </div>

    <div id="q2" class="panel">
      <div class="qhdr"><div class="qtitle" id="q2Title">Q?ï¼ˆMâ€“Mï¼‰</div></div>
      <div id="q2List"></div>
    </div>

    <div class="footer">Design: Sam Chang Ã— Câµ ï½œ å°ˆæ¥­ï¼ˆéˆ¦ç° Ã— é¦™æª³é‡‘ï¼‰</div>
  </div>

  <!-- ç·¨è¼¯ -->
  <dialog id="dlgEdit">
    <form method="dialog">
      <h3 style="margin:6px 0;color:#C8B47E">ç·¨è¼¯é€±æ—¥</h3>
      <div class="row">
        <div>æ—¥æœŸï¼š</div><div id="f_date"></div>
      </div>
      <div class="row">
        <label>ç‹€æ…‹
          <select id="f_state">
            <option value="ok">å¯æ’</option>
            <option value="busy">å·²æ’</option>
            <option value="avoid">é¿é–‹</option>
            <option value="empty">æœªè¨­å®š</option>
          </select>
        </label>
        <label style="flex:1">å‚™è¨»
          <input id="f_note" style="width:100%"/>
        </label>
      </div>
      <div class="row" style="justify-content:flex-end;margin-top:8px">
        <button value="cancel">å–æ¶ˆ</button>
        <button id="btnSave" class="gold">å„²å­˜</button>
      </div>
    </form>
  </dialog>

  <!-- é¿é–‹æ¸…å–®ï¼ˆé›™å­£ï¼‰ -->
  <dialog id="dlgAvoid">
    <form method="dialog">
      <h3 style="margin:6px 0;color:#C8B47E" id="avoidTitle">ğŸ“… é¿é–‹æ—¥æœŸï¼ˆé›™å­£ï¼‰</h3>
      <div id="avoidList" class="panel" style="max-height:50vh;overflow:auto"></div>
      <div class="row" style="justify-content:flex-end;margin-top:8px">
        <button value="cancel">é—œé–‰</button>
      </div>
    </form>
  </dialog>

  <dialog id="dlgLink">
    <form method="dialog">
      <h3 style="margin:6px 0;color:#C8B47E">é€£å…¥æª”æ¡ˆï¼ˆå„é¸ä¸€æ¬¡å³å¯ï¼‰</h3>
      <div class="panel">
        <div>Holiday_CoreFeed.xlsxï¼ˆShared_Data/Holidayï¼‰</div>
        <input type="file" id="pickHoliday" accept=".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"/>
      </div>
      <div class="panel">
        <div>TSAA_Schedule_Core_v1.4.3.xlsxï¼ˆCoreControlï¼‰</div>
        <input type="file" id="pickCore" accept=".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"/>
      </div>
      <div class="panel">
        <div>Scheduler_Log_v1.4.3.xlsxï¼ˆReportsï¼Œå¯ç•¥ï¼‰</div>
        <input type="file" id="pickLog" accept=".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"/>
      </div>
      <div class="row" style="justify-content:flex-end">
        <button value="cancel">å®Œæˆ</button>
      </div>
    </form>
  </dialog>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.20.2/dist/xlsx.full.min.js" integrity="" crossorigin="anonymous"></script>
  <script src="app.js"></script>
  <script>if('serviceWorker'in navigator){navigator.serviceWorker.register('sw.js');}</script>
</body>
</html>